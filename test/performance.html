<html>
<body>
<p>Open in debugger to see rule activity</p>

<script src="../index.js"></script>
<script id="example">

var not = RuleReactor.not;
var insert = RuleReactor.insert;

function Phase() {
	this.name = "match";
}
function Counter() {
	this.count = 0;
	this.max = 5;
}
function Pair(odd,even) {
	this.odd = odd;
	this.even = even;
}
function TestData(id) {
	this.id = (id ? id : 0);
}

RuleReactor.createRule("create",0,{c: Counter,d: TestData},
	function(c, d) {
		return d.id < c.max;
	},
	function(c, d) {
		c.count++;
		insert(new TestData(c.count));
	});
RuleReactor.createRule("name",0,{pair: Pair, phase: Phase},
	function(pair,phase) {
		return !pair.name && phase.name==="name";
	},
	function(pair) {
		pair.name = pair.odd.id + ":" + pair.even.id;
	});
RuleReactor.createRule("pair",0,{d1: TestData, d2: TestData},
	function(d1,d2) {
		return d1.id % 2 === 0 && d2.id % 2 === 1;
	},
	function(d1,d2) {
		insert(new Pair(d2,d1));
	});
		
RuleReactor.trace(0);
var phase = new Phase();
insert(new Counter(), new TestData(),phase,true);
console.log("Performance during addition and heavy join");
console.log("Data Count: ",RuleReactor.data.size);
console.log("Executions: ",RuleReactor.run.executions);
console.log("RPS: ",RuleReactor.run.rps);
console.log("Performance during updates across volumes of data");
phase.name = "name";
RuleReactor.run();
console.log("Data Count: ",RuleReactor.data.size);
console.log("Executions: ",RuleReactor.run.executions);
console.log("RPS: ",RuleReactor.run.rps);

</script>

<script>
document.write("<pre>" + document.getElementById("example").textContent + "</pre>"); 
</script>
</body>
</html>