!function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require
if(!s&&c)return c(a,!0)
if(o)return o(a,!0)
var u=new Error("Cannot find module '"+a+"'")
throw u.code="MODULE_NOT_FOUND",u}var f=n[a]={exports:{}}
t[a][0].call(f.exports,function(e){var n=t[a][1][e]
return i(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a])
return i}({1:[function(e,t,n){(function(){"use strict"
function e(e,t,n){var r=[],i=Array(e.length)
return function o(a){if(a===e.length){var s=e.map(function(e,t){return e[i[t]]})
return t?t(s)?r.push(n?n(s):s):r.length:r.push(n?n(s):s)}for(var c=0;c<e[a].length;++c)i[a]=c,o(a+1)}(0),r}function t(e){Object.keys(e.domain).forEach(function(t){var n=e.domain[t]
n.prototype.rules=n.prototype.rules?n.prototype.rules:{},n.prototype.rules[e.name]=e,n.prototype.activeKeys=n.prototype.activeKeys?n.prototype.activeKeys:{},n.exists=function(e){return e=e?e:function(){return!0},n.instances&&n.instances.some(function(t){return e(t)})},n.forall=function(e){return n.instances&&n.instances.every(function(t){return e(t)})},e.range[t]={},e.bindings[t]=e.bindings[t]?e.bindings[t]:[]
var r=e.condition+""
r.replace(new RegExp("(\\b"+t+"\\.\\w+\\b)","g"),function(r){var i=r.split("."),o=i[1]
return n.prototype.activeKeys[o]=!0,e.range[t][o]=e.range[t][o]?e.range[t][o]:!0,r})})}function n(e,n,r,i,o){this.name=e,this.salience=n,this.domain=r,this.range={},this.condition=i,this.action=o,this.bindings={},this.crossProducts=new Map,this.activations=new Map,t(this)}function r(e,t){this.rule=e,this.bindings=t,i.tracelevel>1&&o.log("Activating: ",this.rule,this.bindings)}var i={},o={}
o.log=function(){console.log.apply(console,arguments)},n.prototype.bind=function(t){var n=this,r=Object.keys(n.bindings),i=[]
r.forEach(function(e){t instanceof n.domain[e]&&n.bindings[e].push(t),i.push(n.bindings[e])}),e(i,function(e){return e.indexOf(t)>=0},function(e){return e.forEach(function(t,i){var o=r[i],a=n.crossProducts.get(o)
a||(a=[],n.crossProducts.set(o,a)),a.push(e)}),e})},n.prototype.unbind=function(e){var t=this,n=Object.keys(t.bindings)
n.forEach(function(n){var r=t.bindings[n].indexOf(e)
r>=0&&t.bindings[n].splice(r,1)}),n.forEach(function(n){if(e instanceof t.domain[n]){var r=t.crossProducts.get(n)
if(r)for(var i=r.length-1;i>=0;i--)if(r[i].indexOf(e)>=0){var o=t.activations.get(r[i])
r.splice(i,1),o&&o["delete"]()}}})},n.prototype.test=function(e,t){var n=this,o=[],a=new Map,s=Object.keys(n.bindings)
e&&t&&!s.some(function(r){return e instanceof n.domain[r]&&n.range[r][t]})||(e?s.forEach(function(r){if(e instanceof n.domain[r]&&(!t||n.range[r][t])){var i=n.crossProducts.get(r)
if(i){var o=[]
i.forEach(function(t){if(t.indexOf(e)>=0){o.push(t)
var r=n.activations.get(t)
r&&r["delete"]()}}),a.set(r,o)}}}):n.crossProducts.forEach(function(e,t){a.set(t,e),e.forEach(function(e){o=n.activations.get(e),o&&o.forEach(function(e){e["delete"]()})})}),a.forEach(function(e){e.forEach(function(e){if(n.condition.apply(n,e)){var t=new r(n,e)
i.agenda.push(t),n.activations.set(e,t)}})}))},n.prototype.reset=function(e,t,n){var r,i=this,o=Object.keys(i.bindings)
t&&n&&!o.some(function(e){return t instanceof i.domain[e]&&i.range[e][n]})||(t?o.forEach(function(e){if(t instanceof i.domain[e]){var n=i.crossProducts.get(e)
n&&n.forEach(function(e){if(e.indexOf(t)>=0){var n=i.activations.get(e)
n&&n["delete"]()}})}}):i.crossProducts.forEach(function(e){e.forEach(function(e){r=i.activations.get(e),r&&r.forEach(function(e){e["delete"]()})})}),e&&i.test(t))},r.prototype.execute=function(){i.tracelevel>0&&o.log("Firing: ",this.rule,this.bindings),this["delete"](),this.rule.action.apply(this.rule,this.bindings)},r.prototype["delete"]=function(e){if(!e||this.bindings.indexOf(e)>=0){i.tracelevel>1&&o.log("Deactivating: ",this.rule,this.bindings),this.rule.activations["delete"](this)
var t=i.agenda.indexOf(this)
t>=0&&i.agenda.splice(t,1)}},i.rules={},i.data=new Set,i.agenda=[],i.trace=function(e){i.tracelevel=e},i.insert=function(){var e=arguments[arguments.length-1]instanceof Object?!1:arguments[arguments.length-1],t=!1,n=[].slice.call(arguments)
n.forEach(function(t){if(t&&"object"==typeof t&&!i.data.has(t)){t.constructor.instances=t.constructor.instances?t.constructor.instances:[],t.constructor.instances.push(t)
var n=Object.keys(t)
t.activeKeys&&Object.keys(t.activeKeys).forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),n.forEach(function(n){function r(){return r.value}function o(o){return r.value!==o?(r.value=o,Object.keys(t.rules).forEach(function(e){t.rules[e].test(t,n)}),o&&o.rules&&setTimeout(function(){i.insert(o,e)}),r.value):void 0}var a,s=Object.getOwnPropertyDescriptor(t,n)
if(s&&(a={},Object.keys(s).forEach(function(e){a[e]=s[e]})),s=s?s:{enumerable:!0,configurable:!1},!s.get||"rrget"!==s.get.name){if(r.value=s.value,r.originalDescriptor=a,s.value instanceof Array||Array.isArray(s.value)){var c=s.value
a.value=c.slice()
var u=["push","pop","splice","shift","unshift"]
u.forEach(function(e){var i=c[e]
if("function"==typeof i){var o=function(){i.apply(c,arguments),Object.keys(t.rules).forEach(function(e){t.rules[e].test(t,n)})}
Object.defineProperty(r.value,e,{configurable:!0,writable:!0,value:o})}}),Object.getOwnPropertyNames(Array.prototype).forEach(function(e){var t=c[e]
"function"==typeof t&&-1===u.indexOf(e)&&Object.defineProperty(r.value,e,{configurable:!0,writable:!0,value:function(){return t.apply(c,arguments)}})})}delete s.value,delete s.writable,s.get=r,s.set=o,Object.defineProperty(t,n,s)}}),t.rules&&Object.keys(t.rules).forEach(function(e){t.rules[e].bind(t)})}}),n.forEach(function(e){e&&"object"==typeof e&&!i.data.has(e)&&(i.data.add(e),e.rules&&(Object.keys(e.rules).forEach(function(t){e.rules[t].test(e)}),t=!0))}),e&&t&&i.run()},i.reset=function(e){if(Object.keys(i.rules).forEach(function(e){i.rules[e].reset()}),e){var t=[]
i.data.forEach(function(e){t.push(e)}),t.push(!1),i.remove(!1)}},i.remove=function(){var e=e=arguments[arguments.length-1]instanceof Object?!1:arguments[arguments.length-1],t=!1,n=[].slice.call(arguments)
n.forEach(function(e){e&&"object"==typeof e&&(i.data["delete"](e),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t)
if("rrget"===n.get.name)if("undefined"==typeof n.get.originalDescriptor)delete e[t]
else{if(n.get.originalDescriptor.value instanceof Array||Array.isArray(n.get.originalDescriptor.value))if(e[t]instanceof Array||Array.isArray(e[t])){var r=[0,e[t]].concat(n.get.originalDescriptor.value)
e[t].splice.apply(e[t],r)}else e[t]=n.get.originalDescriptor.value
Object.defineProperty(e,t,n.get.originalDescriptor)}}),Object.keys(e.rules).forEach(function(t){e.rules[t].unbind(e)}))}),n.forEach(function(e){e&&"object"==typeof e&&e.rules&&(Object.keys(e.rules).forEach(function(t){e.rules[t].test(e)}),t=!0)}),e&&t&&i.run()},i.run=function(e){for(e=e?e:1/0,i.run.executions=0,i.run.start=new Date;i.agenda.length>0&&i.run.executions<e;)i.run.executions++,i.agenda[i.agenda.length-1].execute()
i.run.stop=new Date,i.run.rps=i.run.executions/(i.run.stop.getTime()-i.run.start.getTime())*1e3},i.createRule=function(e,t,r,o,a){var s=new n(e,t,r,o,a)
return i.rules[s.name]=s,s},i.not=function(e){return!e},this.exports?this.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):this.RuleReactor=i}).call("undefined"!=typeof window?window:"undefined"!=typeof t?t:null)},{}]},{},[1])
