!function e(n,t,r){function i(a,c){if(!t[a]){if(!n[a]){var s="function"==typeof require&&require
if(!c&&s)return s(a,!0)
if(o)return o(a,!0)
var u=new Error("Cannot find module '"+a+"'")
throw u.code="MODULE_NOT_FOUND",u}var f=t[a]={exports:{}}
n[a][0].call(f.exports,function(e){var t=n[a][1][e]
return i(t?t:e)},f,f.exports,e,n,t,r)}return t[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a])
return i}({1:[function(e,n,t){(function(){"use strict"
function e(e,n,t){var r=[],i=Array(e.length)
return function o(a){if(a===e.length){var c=e.map(function(e,n){return e[i[n]]})
return n?n(c)?r.push(t?t(c):c):r.length:r.push(t?t(c):c)}for(var s=0;s<e[a].length;++s)i[a]=s,o(a+1)}(0),r}function e(e,n,t){var r,i=0
return e.map(function(e){i=Math.max(i,e.length)}),0===e.length?e.slice():1===e.length?(r=e.slice(),n&&(r=r.filter(function(e,t){return n(e,t)})),t&&r.map(function(e,n){r[n]=t(e,n)}),r):(r=[],e[0].map(function(o){var a=Array(i)
e.map(function(n,t){if(0!==t){var r=0
n.map(function(n){a[r]=Array(e.length),a[r][0]=o,a[r][t]=n,r++})}}),n&&(a=a.filter(function(e,t){return n(e,t)})),t&&a.map(function(e,n){a[n]=t(e,n)}),r.splice(0,0,a)}),r)}function n(e){Object.keys(e.domain).forEach(function(n){var t=e.domain[n]
t.prototype.rules=t.prototype.rules?t.prototype.rules:{},t.prototype.rules[e.name]=e,t.prototype.activeKeys=t.prototype.activeKeys?t.prototype.activeKeys:{},t.exists=function(e){return e=e?e:function(){return!0},t.instances&&t.instances.some(function(n){return e(n)})},t.forall=function(e){return t.instances&&t.instances.every(function(n){return e(n)})},e.range[n]={},e.bindings[n]=e.bindings[n]?e.bindings[n]:[]
var r=e.condition+""
r.replace(new RegExp("(\\b"+n+"\\.\\w+\\b)","g"),function(r){var i=r.split("."),o=i[1]
return t.prototype.activeKeys[o]=!0,e.range[n][o]=e.range[n][o]?e.range[n][o]:!0,r})})}function t(e,n){this.rule=e,this.bindings=n,i.tracelevel>1&&o.log("Activating: ",this.rule,this.bindings)}function r(e,t,r,i,o){this.name=e,this.salience=t,this.domain=r,this.range={},this.condition=i,this.action=o,this.bindings={},this.crossProducts=new Map,this.activations=new Map,n(this)}var i={},o={}
o.log=function(){console.log.apply(console,arguments)},t.prototype.execute=function(){i.tracelevel>0&&o.log("Firing: ",this.rule,this.bindings),this["delete"](),this.rule.action.apply(this.rule,this.bindings)},t.prototype["delete"]=function(e){if(!e||this.bindings.indexOf(e)>=0){i.tracelevel>1&&o.log("Deactivating: ",this.rule,this.bindings),this.rule.activations["delete"](this)
var n=i.agenda.indexOf(this)
n>=0&&i.agenda.splice(n,1)}},r.prototype.bind=function(n){var t=this,r=Object.keys(t.bindings),i=[]
r.forEach(function(e){n instanceof t.domain[e]&&t.bindings[e].push(n),i.push(t.bindings[e])}),e(i,function(e){return e.indexOf(n)>=0},function(e){return e.forEach(function(n,i){var o=r[i],a=t.crossProducts.get(o)
a||(a=[],t.crossProducts.set(o,a)),a.push(e)}),e})},r.prototype.unbind=function(e){var n=this,t=Object.keys(n.bindings)
t.forEach(function(t){var r=n.bindings[t].indexOf(e)
r>=0&&n.bindings[t].splice(r,1)}),t.forEach(function(t){if(e instanceof n.domain[t]){var r=n.crossProducts.get(t)
if(r)for(var i=r.length-1;i>=0;i--)if(r[i].indexOf(e)>=0){var o=n.activations.get(r[i])
r.splice(i,1),o&&o["delete"]()}}})},r.prototype.test=function(e,n){var r=this,o=[],a=new Map,c=Object.keys(r.bindings)
e&&n&&!c.some(function(t){return e instanceof r.domain[t]&&r.range[t][n]})||(e?c.forEach(function(t){if(e instanceof r.domain[t]&&(!n||r.range[t][n])){var i=r.crossProducts.get(t)
if(i){var o=[]
i.forEach(function(n){if(n.indexOf(e)>=0){o.push(n)
var t=r.activations.get(n)
t&&t["delete"]()}}),a.set(t,o)}}}):r.crossProducts.forEach(function(e,n){a.set(n,e),e.forEach(function(e){o=r.activations.get(e),o&&o.forEach(function(e){e["delete"]()})})}),a.forEach(function(e){e.forEach(function(e){if(r.condition.apply(r,e)){var n=new t(r,e)
i.agenda.push(n),r.activations.set(e,n)}})}))},r.prototype.reset=function(e,n,t){var r,i=this,o=Object.keys(i.bindings)
n&&t&&!o.some(function(e){return n instanceof i.domain[e]&&i.range[e][t]})||(n?o.forEach(function(e){if(n instanceof i.domain[e]){var t=i.crossProducts.get(e)
t&&t.forEach(function(e){if(e.indexOf(n)>=0){var t=i.activations.get(e)
t&&t["delete"]()}})}}):i.crossProducts.forEach(function(e){e.forEach(function(e){r=i.activations.get(e),r&&r.forEach(function(e){e["delete"]()})})}),e&&i.test(n))},i.rules={},i.data=new Set,i.agenda=[],i.trace=function(e){i.tracelevel=e},i.insert=function(){var e=arguments[arguments.length-1]instanceof Object?!1:arguments[arguments.length-1],n=!1,t=[].slice.call(arguments)
t.forEach(function(n){if(n&&"object"==typeof n&&!i.data.has(n)){n.constructor.instances=n.constructor.instances?n.constructor.instances:[],n.constructor.instances.push(n)
var t=Object.keys(n)
n.activeKeys&&Object.keys(n.activeKeys).forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t.forEach(function(t){function r(){return r.value}function o(o){return r.value!==o?(r.value=o,Object.keys(n.rules).forEach(function(e){n.rules[e].test(n,t)}),o&&o.rules&&setTimeout(function(){i.insert(o,e)}),r.value):void 0}var a,c=Object.getOwnPropertyDescriptor(n,t)
if(c&&(a={},Object.keys(c).forEach(function(e){a[e]=c[e]})),c=c?c:{enumerable:!0,configurable:!1},!c.get||"rrget"!==c.get.name){if(r.value=c.value,r.originalDescriptor=a,c.value instanceof Array||Array.isArray(c.value)){var s=c.value
a.value=s.slice()
var u=["push","pop","splice","shift","unshift"]
u.forEach(function(e){var i=s[e]
if("function"==typeof i){var o=function(){i.apply(s,arguments),Object.keys(n.rules).forEach(function(e){n.rules[e].test(n,t)})}
Object.defineProperty(r.value,e,{configurable:!0,writable:!0,value:o})}}),Object.getOwnPropertyNames(Array.prototype).forEach(function(e){var n=s[e]
"function"==typeof n&&-1===u.indexOf(e)&&Object.defineProperty(r.value,e,{configurable:!0,writable:!0,value:function(){return n.apply(s,arguments)}})})}delete c.value,delete c.writable,c.get=r,c.set=o,Object.defineProperty(n,t,c)}}),n.rules&&Object.keys(n.rules).forEach(function(e){n.rules[e].bind(n)})}}),t.forEach(function(e){e&&"object"==typeof e&&!i.data.has(e)&&(i.data.add(e),e.rules&&(Object.keys(e.rules).forEach(function(n){e.rules[n].test(e)}),n=!0))}),e&&n&&i.run()},i.reset=function(e){if(Object.keys(i.rules).forEach(function(e){i.rules[e].reset()}),e){var n=[]
i.data.forEach(function(e){n.push(e)}),n.push(!1),i.remove(!1)}},i.remove=function(){var e=e=arguments[arguments.length-1]instanceof Object?!1:arguments[arguments.length-1],n=!1,t=[].slice.call(arguments)
t.forEach(function(e){e&&"object"==typeof e&&(i.data["delete"](e),Object.keys(e).forEach(function(n){var t=Object.getOwnPropertyDescriptor(e,n)
if("rrget"===t.get.name)if("undefined"==typeof t.get.originalDescriptor)delete e[n]
else{if(t.get.originalDescriptor.value instanceof Array||Array.isArray(t.get.originalDescriptor.value))if(e[n]instanceof Array||Array.isArray(e[n])){var r=[0,e[n]].concat(t.get.originalDescriptor.value)
e[n].splice.apply(e[n],r)}else e[n]=t.get.originalDescriptor.value
Object.defineProperty(e,n,t.get.originalDescriptor)}}),Object.keys(e.rules).forEach(function(n){e.rules[n].unbind(e)}))}),t.forEach(function(e){e&&"object"==typeof e&&e.rules&&(Object.keys(e.rules).forEach(function(n){e.rules[n].test(e)}),n=!0)}),e&&n&&i.run()},i.run=function(e){for(e=e?e:1/0,i.run.executions=0,i.run.start=new Date;i.agenda.length>0&&i.run.executions<e;)i.run.executions++,i.agenda[i.agenda.length-1].execute()
i.run.stop=new Date,i.run.rps=i.run.executions/(i.run.stop.getTime()-i.run.start.getTime())*1e3},i.createRule=function(e,n,t,o,a){var c=new r(e,n,t,o,a)
return i.rules[c.name]=c,c},i.not=function(e){return!e},this.exports?this.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):this.RuleReactor=i}).call("undefined"!=typeof window?window:"undefined"!=typeof n?n:null)},{}]},{},[1])
